{
  "version": 3,
  "sources": ["../../../node_modules/webextension-polyfill/dist/browser-polyfill.js", "../src/browser-polyfill.ts", "../src/popup.ts", "../src/storage.ts"],
  "sourcesContent": ["/* webextension-polyfill - v0.10.0 - Fri Aug 12 2022 19:42:44 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (!globalThis.chrome?.runtime?.id) {\n  throw new Error(\"This script should only be loaded in a browser extension.\");\n}\n\nif (typeof globalThis.browser === \"undefined\" || Object.getPrototypeOf(globalThis.browser) !== Object.prototype) {\n  const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = extensionAPIs => {\n    // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n    // at build time by replacing the following \"include\" with the content of the\n    // JSON file.\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"disable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"enable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"openPopup\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"browsingData\": {\n        \"remove\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"removeCache\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCookies\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeDownloads\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFormData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeHistory\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeLocalStorage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePasswords\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePluginData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"settings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"devtools\": {\n        \"inspectedWindow\": {\n          \"eval\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2,\n            \"singleCallbackArg\": false\n          }\n        },\n        \"panels\": {\n          \"create\": {\n            \"minArgs\": 3,\n            \"maxArgs\": 3,\n            \"singleCallbackArg\": true\n          },\n          \"elements\": {\n            \"createSidebarPane\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        }\n      },\n      \"downloads\": {\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"identity\": {\n        \"launchWebAuthFlow\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setEnabled\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"permissions\": {\n        \"contains\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"request\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getDevices\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"discard\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goBack\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goForward\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"topSites\": {\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    if (Object.keys(apiMetadata).length === 0) {\n      throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n    }\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.reject\n     *        The promise's rejection function.\n     * @param {object} metadata\n     *        Metadata about the wrapped method which has created the callback.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = (promise, metadata) => {\n      return (...callbackArgs) => {\n        if (extensionAPIs.runtime.lastError) {\n          promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n        } else if (metadata.singleCallbackArg ||\n                   (callbackArgs.length <= 1 && metadata.singleCallbackArg !== false)) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          if (metadata.fallbackToNoCallback) {\n            // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n            // and so the polyfill will try to call it with a callback first, and it will fallback\n            // to not passing the callback if the first call fails.\n            try {\n              target[name](...args, makeCallback({resolve, reject}, metadata));\n            } catch (cbError) {\n              console.warn(`${name} API method doesn't seem to support the callback parameter, ` +\n                           \"falling back to call it without a callback: \", cbError);\n\n              target[name](...args);\n\n              // Update the API method metadata, so that the next API calls will not try to\n              // use the unsupported callback anymore.\n              metadata.fallbackToNoCallback = false;\n              metadata.noCallback = true;\n\n              resolve();\n            }\n          } else if (metadata.noCallback) {\n            target[name](...args);\n            resolve();\n          } else {\n            target[name](...args, makeCallback({resolve, reject}, metadata));\n          }\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the original method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n      let handlers = {\n        has(proxyTarget, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(proxyTarget, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else if (hasOwnProperty(metadata, \"*\")) {\n            // Wrap all properties in * namespace.\n            value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(proxyTarget, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(proxyTarget, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(proxyTarget, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      // Per contract of the Proxy API, the \"get\" proxy handler must return the\n      // original value of the target if that value is declared read-only and\n      // non-configurable. For this reason, we create an object with the\n      // prototype set to `target` instead of using `target` directly.\n      // Otherwise we cannot return a custom object for APIs that\n      // are declared read-only and non-configurable, such as `chrome.devtools`.\n      //\n      // The proxy handlers themselves will still use the original `target`\n      // instead of the `proxyTarget`, so that the methods and properties are\n      // dereferenced via the original targets.\n      let proxyTarget = Object.create(target);\n      return new Proxy(proxyTarget, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps an onRequestFinished listener function so that it will return a\n       * `getContent()` property which returns a `Promise` rather than using a\n       * callback API.\n       *\n       * @param {object} req\n       *        The HAR entry object representing the network request.\n       */\n      return function onRequestFinished(req) {\n        const wrappedReq = wrapObject(req, {} /* wrappers */, {\n          getContent: {\n            minArgs: 0,\n            maxArgs: 0,\n          },\n        });\n        listener(wrappedReq);\n      };\n    });\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let didCallSendResponse = false;\n\n        let wrappedSendResponse;\n        let sendResponsePromise = new Promise(resolve => {\n          wrappedSendResponse = function(response) {\n            didCallSendResponse = true;\n            resolve(response);\n          };\n        });\n\n        let result;\n        try {\n          result = listener(message, sender, wrappedSendResponse);\n        } catch (err) {\n          result = Promise.reject(err);\n        }\n\n        const isResultThenable = result !== true && isThenable(result);\n\n        // If the listener didn't returned true or a Promise, or called\n        // wrappedSendResponse synchronously, we can exit earlier\n        // because there will be no response sent from this listener.\n        if (result !== true && !isResultThenable && !didCallSendResponse) {\n          return false;\n        }\n\n        // A small helper to send the message if the promise resolves\n        // and an error if the promise rejects (a wrapped sendMessage has\n        // to translate the message into a resolved promise or a rejected\n        // promise).\n        const sendPromisedResult = (promise) => {\n          promise.then(msg => {\n            // send the message value.\n            sendResponse(msg);\n          }, error => {\n            // Send a JSON representation of the error if the rejected value\n            // is an instance of error, or the object itself otherwise.\n            let message;\n            if (error && (error instanceof Error ||\n                typeof error.message === \"string\")) {\n              message = error.message;\n            } else {\n              message = \"An unexpected error occurred\";\n            }\n\n            sendResponse({\n              __mozWebExtensionPolyfillReject__: true,\n              message,\n            });\n          }).catch(err => {\n            // Print an error on the console if unable to send the response.\n            console.error(\"Failed to send onMessage rejected reply\", err);\n          });\n        };\n\n        // If the listener returned a Promise, send the resolved value as a\n        // result, otherwise wait the promise related to the wrappedSendResponse\n        // callback to resolve and send it as a response.\n        if (isResultThenable) {\n          sendPromisedResult(result);\n        } else {\n          sendPromisedResult(sendResponsePromise);\n        }\n\n        // Let Chrome know that the listener is replying.\n        return true;\n      };\n    });\n\n    const wrappedSendMessageCallback = ({reject, resolve}, reply) => {\n      if (extensionAPIs.runtime.lastError) {\n        // Detect when none of the listeners replied to the sendMessage call and resolve\n        // the promise to undefined as in Firefox.\n        // See https://github.com/mozilla/webextension-polyfill/issues/130\n        if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n          resolve();\n        } else {\n          reject(new Error(extensionAPIs.runtime.lastError.message));\n        }\n      } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n        // Convert back the JSON representation of the error into\n        // an Error instance.\n        reject(new Error(reply.message));\n      } else {\n        resolve(reply);\n      }\n    };\n\n    const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n      if (args.length < metadata.minArgs) {\n        throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      if (args.length > metadata.maxArgs) {\n        throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      return new Promise((resolve, reject) => {\n        const wrappedCb = wrappedSendMessageCallback.bind(null, {resolve, reject});\n        args.push(wrappedCb);\n        apiNamespaceObj.sendMessage(...args);\n      });\n    };\n\n    const staticWrappers = {\n      devtools: {\n        network: {\n          onRequestFinished: wrapEvent(onRequestFinishedWrappers),\n        },\n      },\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n        onMessageExternal: wrapEvent(onMessageWrappers),\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 1, maxArgs: 3}),\n      },\n      tabs: {\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 2, maxArgs: 3}),\n      },\n    };\n    const settingMetadata = {\n      clear: {minArgs: 1, maxArgs: 1},\n      get: {minArgs: 1, maxArgs: 1},\n      set: {minArgs: 1, maxArgs: 1},\n    };\n    apiMetadata.privacy = {\n      network: {\"*\": settingMetadata},\n      services: {\"*\": settingMetadata},\n      websites: {\"*\": settingMetadata},\n    };\n\n    return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n  };\n\n  // The build process adds a UMD wrapper around this file, which makes the\n  // `module` variable available.\n  module.exports = wrapAPIs(chrome);\n} else {\n  module.exports = globalThis.browser;\n}\n", "// Browser API compatibility layer with Safari-specific enhancements\nimport browserPolyfill from \"webextension-polyfill\";\n\n// Type for Safari-specific properties\ninterface SafariExtensions {\n  _isSafari?: boolean;\n  _isIOS?: boolean;\n}\n\n// Create a type that combines browser API with Safari extensions\ntype SafariBrowserAPI = typeof browserPolyfill & SafariExtensions;\n\n// Export the browser API with proper typing\nexport const browser: SafariBrowserAPI = (() => {\n  const api = browserPolyfill as SafariBrowserAPI;\n  \n  // Detect Safari\n  api._isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  api._isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !(window as any).MSStream;\n  \n  return api;\n})();\n\n// Also export as chrome for compatibility\nexport const chrome = browser;\n\n// Safari-specific API fallbacks and utilities\nexport const safariCompat = {\n  // Safari doesn't support browser.runtime.openOptionsPage on iOS\n  openOptionsPage: async (): Promise<void> => {\n    try {\n      if (browser.runtime.openOptionsPage && !browser._isIOS) {\n        await browser.runtime.openOptionsPage();\n      } else {\n        // Fallback: open in new tab\n        const optionsUrl = browser.runtime.getURL(\"options.html\");\n        await browser.tabs.create({ url: optionsUrl });\n      }\n    } catch (error) {\n      console.error(\"[safariCompat] Failed to open options page:\", error);\n      // Last resort: try to open in current tab\n      const optionsUrl = browser.runtime.getURL(\"options.html\");\n      window.open(optionsUrl, \"_blank\");\n    }\n  },\n  \n  // Check if running on Safari\n  isSafari: (): boolean => browser._isSafari || false,\n  \n  // Check if running on iOS\n  isIOS: (): boolean => browser._isIOS || false,\n  \n  // Safari storage fallbacks (Safari has 10MB limit vs Chrome's unlimited)\n  safeStorageSet: async (items: Record<string, any>): Promise<void> => {\n    try {\n      await browser.storage.local.set(items);\n    } catch (error: any) {\n      if (error.message?.includes(\"quota\")) {\n        console.error(\"[safariCompat] Storage quota exceeded, attempting cleanup...\");\n        // Try to clear old data\n        const keys = Object.keys(await browser.storage.local.get());\n        if (keys.length > 100) {\n          // Remove oldest entries (assuming keys have timestamps)\n          const toRemove = keys.slice(0, Math.floor(keys.length * 0.2));\n          await browser.storage.local.remove(toRemove);\n          // Retry\n          await browser.storage.local.set(items);\n        }\n      } else {\n        throw error;\n      }\n    }\n  },\n  \n  // Context menus compatibility (not supported on iOS)\n  supportsContextMenus: (): boolean => {\n    return !browser._isIOS && typeof browser.contextMenus !== \"undefined\";\n  },\n  \n  // Permissions check with Safari fallbacks\n  hasPermission: async (permission: string): Promise<boolean> => {\n    if (!browser.permissions?.contains) {\n      console.warn(\"[safariCompat] Permissions API not available\");\n      return false;\n    }\n    \n    try {\n      const result = await browser.permissions.contains({ permissions: [permission] });\n      return result;\n    } catch (error) {\n      console.error(`[safariCompat] Failed to check permission ${permission}:`, error);\n      return false;\n    }\n  }\n};\n\n// Make browser API available globally if needed\ndeclare global {\n  interface Window {\n    browser?: typeof browserPolyfill;\n    chrome?: typeof browserPolyfill;\n  }\n}\n\nif (typeof (globalThis as any).browser === \"undefined\") {\n  (globalThis as any).browser = browser;\n}\nif (typeof (globalThis as any).chrome === \"undefined\") {\n  (globalThis as any).chrome = browser;\n}", "// Anno Safari\u62E1\u5F35 Popup UI \u30ED\u30B8\u30C3\u30AF\u96DB\u5F62\n// JSDoc\u4ED8\u304D\n\nimport { browser } from \"./browser-polyfill\";\nimport { loadSettings, saveSettings, encryptApiKey, decryptApiKey, Settings } from \"./storage\";\n\n/**\n * \u73FE\u5728\u306E\u30A2\u30AF\u30C6\u30A3\u30D6\u30BF\u30D6\u306BextractPageData\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u9001\u308A\u3001\u672C\u6587\u30C7\u30FC\u30BF\u3092\u53D6\u5F97\n */\nasync function getPageDataFromActiveTab(): Promise<{ title: string; url: string; text: string } | null> {\n    return new Promise((resolve) => {\n        browser.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n            const tab = tabs[0];\n            if (!tab?.id) return resolve(null);\n            browser.tabs.sendMessage(tab.id, { type: \"extractPageData\" }, (res) => {\n                resolve(res ?? null);\n            });\n        });\n    });\n}\n\n/**\n * background\u306B\u8981\u7D04\u751F\u6210\u30EA\u30AF\u30A8\u30B9\u30C8\u3092\u9001\u308A\u3001\u8981\u7D04\u3092\u53D7\u3051\u53D6\u308B\n */\nasync function requestSummaryFromBackground({ apiKey, model, text, url, maxTokens, temperature }: {\n    apiKey: string;\n    model: string;\n    text: string;\n    url: string;\n    maxTokens: number;\n    temperature: number;\n}): Promise<string> {\n    return new Promise((resolve, reject) => {\n        browser.runtime.sendMessage(\n            {\n                type: \"generateSummary\",\n                apiKey,\n                model,\n                text,\n                url,\n                maxTokens,\n                temperature,\n            },\n            (res) => {\n                if (res?.summary) return resolve(res.summary);\n                reject(res?.error || \"\u8981\u7D04\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\");\n            }\n        );\n    });\n}\n\n/**\n * Scrapbox\u6295\u7A3F\u7528\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8\u3092\u751F\u6210\n */\nfunction buildScrapboxBody({ summary, url, title }: { summary: string; url: string; title: string }): string {\n    return [\n        '> [chatgpt.icon] ' + summary,\n        `> [source.icon] [${url} \u30AF\u30EA\u30C3\u30D7\u5143]`,\n        '> [tags] #anno #summary',\n        '--',\n        `> ${title}`,\n    ].join('\\n');\n}\n\n/**\n * background\u306BScrapbox\u6295\u7A3F\u30EA\u30AF\u30A8\u30B9\u30C8\u3092\u9001\u308B\n */\nasync function postToScrapbox({ body, title }: { body: string; title: string }): Promise<void> {\n    return new Promise((resolve, reject) => {\n        browser.runtime.sendMessage(\n            { type: \"postToScrapbox\", body, title },\n            (res) => {\n                if (res?.success) return resolve();\n                reject(res?.error || \"Scrapbox\u6295\u7A3F\u306B\u5931\u6557\u3057\u307E\u3057\u305F\");\n            }\n        );\n    });\n}\n\n/**\n * Popup\u30D5\u30A9\u30FC\u30E0\u306E\u521D\u671F\u5316\u30FB\u30A4\u30D9\u30F3\u30C8\u30CF\u30F3\u30C9\u30E9\u767B\u9332\n */\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n    const clipBtn = document.getElementById(\"clip-btn\") as HTMLButtonElement;\n    const openSettingsBtn = document.getElementById(\"open-settings-btn\") as HTMLButtonElement;\n    const feedback = document.getElementById(\"feedback\") as HTMLDivElement;\n\n    // \u8A2D\u5B9A\u5024\u3092browser.storage\u304B\u3089\u53D6\u5F97\n    const settings: Settings = await loadSettings();\n    const project = settings.project || \"\";\n    const apiKey = settings.encryptedApiKey ? await decryptApiKey(settings.encryptedApiKey) : \"\";\n    \n    // \u30C7\u30D0\u30C3\u30B0\u7528\uFF1A\u8A2D\u5B9A\u5185\u5BB9\u3092\u30B3\u30F3\u30BD\u30FC\u30EB\u306B\u51FA\u529B\n    console.log(\"Anno Settings:\", {\n        project: project || \"\u672A\u8A2D\u5B9A\",\n        annoProjectName: settings.annoProjectName || \"\u672A\u8A2D\u5B9A\",\n        hasApiKey: !!apiKey,\n        allSettings: settings\n    });\n\n    // \u8A2D\u5B9A\u672A\u5B8C\u4E86\u306A\u3089Clip\u30DC\u30BF\u30F3\u975E\u8868\u793A\uFF06\u8A2D\u5B9A\u30DC\u30BF\u30F3\u8868\u793A\n    if (!project || !apiKey) {\n        clipBtn.style.display = \"none\";\n        openSettingsBtn.style.display = \"block\";\n        openSettingsBtn.addEventListener(\"click\", () => {\n            browser.runtime.openOptionsPage();\n        });\n        feedback.textContent = \"\u521D\u56DE\u306FProject\u3068API Key\u306E\u8A2D\u5B9A\u304C\u5FC5\u8981\u3067\u3059\";\n        return;\n    } else {\n        clipBtn.style.display = \"block\";\n        openSettingsBtn.style.display = \"none\";\n    }\n\n    // Clip\u30DC\u30BF\u30F3\u62BC\u4E0B\u6642\u306E\u51E6\u7406\uFF08\u65E2\u5B58\u306E\u8981\u7D04\u30FB\u6295\u7A3F\u30D5\u30ED\u30FC\u3092\u3053\u3053\u306B\uFF09\n    document.getElementById(\"clip-form\")?.addEventListener(\"submit\", async (e) => {\n        e.preventDefault();\n        feedback.textContent = \"\u2026generating summary\";\n        clipBtn.disabled = true;\n\n        // \u30E2\u30C7\u30EB\u306F\u5E38\u306Bgpt-4o\u306B\u56FA\u5B9A\n        const model = \"gpt-4o\";\n        const maxTokens = settings.maxTokens || 160;\n        const temperature = settings.temperature ?? 0.3;\n        const autoInsert = settings.autoInsertSummary ?? true;\n\n        // \u672C\u6587\u30C7\u30FC\u30BF\u3092content script\u304B\u3089\u53D6\u5F97\n        const pageData = await getPageDataFromActiveTab();\n        if (!pageData) {\n            feedback.textContent = \"\u672C\u6587\u62BD\u51FA\u306B\u5931\u6557\u3057\u307E\u3057\u305F\";\n            clipBtn.disabled = false;\n            return;\n        }\n\n        // background\u306B\u8981\u7D04\u751F\u6210\u30EA\u30AF\u30A8\u30B9\u30C8\n        let summary = \"\";\n        try {\n            summary = await requestSummaryFromBackground({\n                apiKey,\n                model,\n                text: pageData.text,\n                url: pageData.url,\n                maxTokens,\n                temperature,\n            });\n            console.log(\"\u8981\u7D04\", summary);\n        } catch (e) {\n            feedback.textContent = `\u8981\u7D04\u751F\u6210\u30A8\u30E9\u30FC: ${e}`;\n            clipBtn.disabled = false;\n            return;\n        }\n\n        // Scrapbox\u6295\u7A3F\u7528\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8\u751F\u6210\n        const body = buildScrapboxBody({ summary, url: pageData.url, title: pageData.title });\n        try {\n            await postToScrapbox({ body, title: pageData.title });\n            feedback.textContent = \"done\";\n        } catch (e) {\n            feedback.textContent = `Scrapbox\u6295\u7A3F\u30A8\u30E9\u30FC: ${e}`;\n        }\n        clipBtn.disabled = false;\n    });\n});\n\n/**\n * \u4ECA\u5F8C\u306E\u62E1\u5F35\u30DD\u30A4\u30F3\u30C8:\n * - browser.storage\u3068\u306E\u9023\u643A\n * - AES-GCM\u6697\u53F7\u5316/\u5FA9\u53F7\n * - OpenAI API\u547C\u3073\u51FA\u3057\n * - i18n\u5BFE\u5FDC\n */\n", "import { browser, safariCompat } from \"./browser-polyfill\";\nimport type { ExtensionSettings } from \"./types/messages\";\n\n// Safari storage limits\nconst SAFARI_STORAGE_LIMIT = 10 * 1024 * 1024; // 10MB\nconst STORAGE_WARNING_THRESHOLD = 0.8; // Warn at 80% usage\n\nexport const initialStorageValues: ExtensionSettings = {\n  annoProjectName: \"\",\n  enableAutoInjection: true,\n  debugMode: false,\n  storageQuotaWarningThreshold: STORAGE_WARNING_THRESHOLD,\n};\n\nexport interface Settings extends ExtensionSettings {\n  project?: string;\n  encryptedApiKey?: string;\n  maxTokens?: number;\n  temperature?: number;\n  autoInsertSummary?: boolean;\n}\n\n// Storage usage monitoring\nexport interface StorageInfo {\n  bytesUsed: number;\n  quotaBytes: number;\n  percentUsed: number;\n  isNearQuota: boolean;\n}\n\n/**\n * Get current storage usage information\n */\nexport async function getStorageInfo(): Promise<StorageInfo> {\n  try {\n    // Safari doesn't support browser.storage.local.getBytesInUse\n    if ('getBytesInUse' in browser.storage.local && typeof browser.storage.local.getBytesInUse === 'function') {\n      const bytesUsed = await browser.storage.local.getBytesInUse();\n      const quotaBytes = SAFARI_STORAGE_LIMIT;\n      const percentUsed = bytesUsed / quotaBytes;\n      \n      return {\n        bytesUsed,\n        quotaBytes,\n        percentUsed,\n        isNearQuota: percentUsed >= STORAGE_WARNING_THRESHOLD,\n      };\n    } else {\n      // Fallback: estimate storage usage\n      const allData = await browser.storage.local.get();\n      const dataString = JSON.stringify(allData);\n      const bytesUsed = new Blob([dataString]).size;\n      const quotaBytes = SAFARI_STORAGE_LIMIT;\n      const percentUsed = bytesUsed / quotaBytes;\n      \n      return {\n        bytesUsed,\n        quotaBytes,\n        percentUsed,\n        isNearQuota: percentUsed >= STORAGE_WARNING_THRESHOLD,\n      };\n    }\n  } catch (error) {\n    console.error(\"[storage] Failed to get storage info:\", error);\n    return {\n      bytesUsed: 0,\n      quotaBytes: SAFARI_STORAGE_LIMIT,\n      percentUsed: 0,\n      isNearQuota: false,\n    };\n  }\n}\n\n/**\n * Load settings from browser storage with error handling\n */\nexport async function loadSettings(): Promise<Settings> {\n  try {\n    // Try sync storage first (smaller quota but syncs across devices)\n    const syncData = await browser.storage.sync.get(initialStorageValues);\n    \n    // Merge with local storage for larger data\n    const localData = await browser.storage.local.get();\n    \n    return { ...initialStorageValues, ...syncData, ...localData } as Settings;\n  } catch (error) {\n    console.error(\"[storage] Failed to load settings:\", error);\n    return initialStorageValues as Settings;\n  }\n}\n\n/**\n * Save settings to browser storage with Safari compatibility\n */\nexport async function saveSettings(settings: Partial<Settings>): Promise<void> {\n  try {\n    // Separate small settings for sync storage\n    const syncSettings: Partial<Settings> = {\n      annoProjectName: settings.annoProjectName,\n      enableAutoInjection: settings.enableAutoInjection,\n      debugMode: settings.debugMode,\n    };\n    \n    // Large data goes to local storage\n    const localSettings: Partial<Settings> = {\n      project: settings.project,\n      encryptedApiKey: settings.encryptedApiKey,\n      maxTokens: settings.maxTokens,\n      temperature: settings.temperature,\n      autoInsertSummary: settings.autoInsertSummary,\n    };\n    \n    // Remove undefined values\n    const cleanSyncSettings = Object.fromEntries(\n      Object.entries(syncSettings).filter(([_, v]) => v !== undefined)\n    );\n    const cleanLocalSettings = Object.fromEntries(\n      Object.entries(localSettings).filter(([_, v]) => v !== undefined)\n    );\n    \n    // Save to appropriate storage\n    if (Object.keys(cleanSyncSettings).length > 0) {\n      await browser.storage.sync.set(cleanSyncSettings);\n    }\n    \n    if (Object.keys(cleanLocalSettings).length > 0) {\n      await safariCompat.safeStorageSet(cleanLocalSettings);\n    }\n    \n    // Check storage usage after save\n    const storageInfo = await getStorageInfo();\n    if (storageInfo.isNearQuota) {\n      console.warn(\n        `[storage] Storage usage is at ${(storageInfo.percentUsed * 100).toFixed(1)}% of quota`\n      );\n    }\n  } catch (error) {\n    console.error(\"[storage] Failed to save settings:\", error);\n    throw error;\n  }\n}\n\n/**\n * Clear old or unnecessary data to free up storage\n */\nexport async function cleanupStorage(): Promise<void> {\n  try {\n    const storageInfo = await getStorageInfo();\n    if (!storageInfo.isNearQuota) {\n      return;\n    }\n    \n    console.log(\"[storage] Cleaning up storage...\");\n    \n    // Get all stored data\n    const allData = await browser.storage.local.get();\n    const keys = Object.keys(allData);\n    \n    // Identify old or large entries (customize based on your data structure)\n    const keysToRemove: string[] = [];\n    \n    for (const key of keys) {\n      // Remove old cache entries (assuming they have timestamps)\n      if (key.startsWith(\"cache_\") && allData[key]?.timestamp) {\n        const age = Date.now() - allData[key].timestamp;\n        if (age > 7 * 24 * 60 * 60 * 1000) { // 7 days\n          keysToRemove.push(key);\n        }\n      }\n      \n      // Remove large entries that aren't critical\n      const dataSize = new Blob([JSON.stringify(allData[key])]).size;\n      if (dataSize > 100 * 1024 && !isEssentialData(key)) { // 100KB\n        keysToRemove.push(key);\n      }\n    }\n    \n    if (keysToRemove.length > 0) {\n      await browser.storage.local.remove(keysToRemove);\n      console.log(`[storage] Removed ${keysToRemove.length} entries`);\n    }\n  } catch (error) {\n    console.error(\"[storage] Cleanup failed:\", error);\n  }\n}\n\n/**\n * Check if a storage key contains essential data\n */\nfunction isEssentialData(key: string): boolean {\n  const essentialKeys = [\n    \"annoProjectName\",\n    \"encryptedApiKey\",\n    \"settings\",\n    \"userPreferences\",\n  ];\n  \n  return essentialKeys.some(essential => key.includes(essential));\n}\n\n/**\n * Encrypt API key using Web Crypto API\n */\nexport async function encryptApiKey(apiKey: string): Promise<string> {\n  try {\n    // Generate a key from a passphrase (in production, use a secure key)\n    const encoder = new TextEncoder();\n    const keyMaterial = await crypto.subtle.importKey(\n      \"raw\",\n      encoder.encode(\"anno-safari-extension-key\"), // Use a secure key in production\n      { name: \"PBKDF2\" },\n      false,\n      [\"deriveKey\"]\n    );\n    \n    const key = await crypto.subtle.deriveKey(\n      {\n        name: \"PBKDF2\",\n        salt: encoder.encode(\"anno-salt\"), // Use a random salt in production\n        iterations: 100000,\n        hash: \"SHA-256\",\n      },\n      keyMaterial,\n      { name: \"AES-GCM\", length: 256 },\n      false,\n      [\"encrypt\", \"decrypt\"]\n    );\n    \n    // Encrypt the API key\n    const iv = crypto.getRandomValues(new Uint8Array(12));\n    const encrypted = await crypto.subtle.encrypt(\n      { name: \"AES-GCM\", iv },\n      key,\n      encoder.encode(apiKey)\n    );\n    \n    // Combine IV and encrypted data\n    const combined = new Uint8Array(iv.length + encrypted.byteLength);\n    combined.set(iv);\n    combined.set(new Uint8Array(encrypted), iv.length);\n    \n    // Convert to base64\n    return btoa(String.fromCharCode(...combined));\n  } catch (error) {\n    console.error(\"[storage] Encryption failed:\", error);\n    // Fallback to simple encoding (not secure)\n    return btoa(apiKey);\n  }\n}\n\n/**\n * Decrypt API key using Web Crypto API\n */\nexport async function decryptApiKey(encryptedKey: string): Promise<string> {\n  try {\n    // Convert from base64\n    const combined = Uint8Array.from(atob(encryptedKey), c => c.charCodeAt(0));\n    \n    // Extract IV and encrypted data\n    const iv = combined.slice(0, 12);\n    const encrypted = combined.slice(12);\n    \n    // Generate the same key\n    const encoder = new TextEncoder();\n    const keyMaterial = await crypto.subtle.importKey(\n      \"raw\",\n      encoder.encode(\"anno-safari-extension-key\"), // Use the same secure key\n      { name: \"PBKDF2\" },\n      false,\n      [\"deriveKey\"]\n    );\n    \n    const key = await crypto.subtle.deriveKey(\n      {\n        name: \"PBKDF2\",\n        salt: encoder.encode(\"anno-salt\"), // Use the same salt\n        iterations: 100000,\n        hash: \"SHA-256\",\n      },\n      keyMaterial,\n      { name: \"AES-GCM\", length: 256 },\n      false,\n      [\"encrypt\", \"decrypt\"]\n    );\n    \n    // Decrypt\n    const decrypted = await crypto.subtle.decrypt(\n      { name: \"AES-GCM\", iv },\n      key,\n      encrypted\n    );\n    \n    return new TextDecoder().decode(decrypted);\n  } catch (error) {\n    console.error(\"[storage] Decryption failed:\", error);\n    // Fallback to simple decoding\n    return atob(encryptedKey);\n  }\n}"],
  "mappings": "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",
  "names": ["globalThis", "chrome", "runtime", "id", "Error", "browser", "Object", "getPrototypeOf", "prototype", "CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE", "wrapAPIs", "extensionAPIs", "apiMetadata", "keys", "length", "DefaultWeakMap", "WeakMap", "constructor", "createItem", "items", "undefined", "get", "key", "has", "set", "isThenable", "value", "then", "makeCallback", "promise", "metadata", "callbackArgs", "lastError", "reject", "message", "singleCallbackArg", "resolve", "pluralizeArguments", "numArgs", "wrapAsyncFunction", "name", "asyncFunctionWrapper", "target", "args", "minArgs", "maxArgs", "Promise", "fallbackToNoCallback", "cbError", "console", "warn", "noCallback", "wrapMethod", "method", "wrapper", "Proxy", "apply", "targetMethod", "thisObj", "call", "hasOwnProperty", "Function", "bind", "wrapObject", "wrappers", "cache", "create", "handlers", "proxyTarget", "prop", "receiver", "defineProperty", "configurable", "enumerable", "desc", "Reflect", "deleteProperty", "wrapEvent", "wrapperMap", "addListener", "listener", "hasListener", "removeListener", "onRequestFinishedWrappers", "onRequestFinished", "req", "wrappedReq", "getContent", "onMessageWrappers", "onMessage", "sender", "sendResponse", "didCallSendResponse", "wrappedSendResponse", "sendResponsePromise", "response", "result", "err", "isResultThenable", "sendPromisedResult", "msg", "error", "__mozWebExtensionPolyfillReject__", "catch", "wrappedSendMessageCallback", "reply", "wrappedSendMessage", "apiNamespaceObj", "wrappedCb", "push", "sendMessage", "staticWrappers", "devtools", "network", "onMessageExternal", "tabs", "settingMetadata", "clear", "privacy", "services", "websites", "module", "exports", "browserPolyfill", "e"]
}
